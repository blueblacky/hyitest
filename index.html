<!DOCTYPE html>
<html>
    <head>
       <title>High Yield India</title>
	<!-- CSS -->
    <script type="text/javascript" src="js/jquery-1.10.2.min.js"></script>	
	<script type="text/javascript" src="js/responsivemobilemenu.js"></script>
	<script type="text/javascript" src="js/jquery-ui-timepicker-addon.js"></script>
	<!-- CSS -->
	<!-- JS -->
	<link rel="stylesheet" href="css/responsivemobilemenu.css" type="text/css"/>
	<link rel="stylesheet" href="css/jquery-ui-timepicker-addon.css" type="text/css"/>
	<link rel="stylesheet" href="css/style.css" type="text/css"/>
	
	<link href="css/jquery-ui-1.10.4.custom.css" rel="stylesheet">	
	<script src="js/jquery-ui-1.10.4.custom.js"></script>
	
	<script src="js/jquery.min.js"></script>
	<link rel="stylesheet" href="css/bootstrap.min.css">

	<link rel="stylesheet" href="css/bootstrap-theme.min.css">
	<script src="css/bootstrap.min.js"></script>
	
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no"/>
	<!-- JS -->
    </head>
    <body>
	<div id="title">
		<img src="img/logo.png" alt="" id="title_image" style="padding:5px 0 0 0;" /> <span id="title_text">Upload</span>		
	</div>
	<div class="rmm" data-menu-style = "minimal">
            <ul>
                <li><a href='index.html'>Home</a></li>
				<li><a href='upload.html'>Upload</a></li>
                <li><a href='upload_2.html'>Logout</a></li>                  
            </ul>
    </div>
	<div id="container">
			<ul>
				<li>Select Your Files</li>
				<li> 
				 <div id="upload_form">
						<!--id="file_upload_form" -->
						<form  id="uploadimage" method="post" enctype="multipart/form-data" action="#">
							<input name="file_id" id="file_id" size="27" type="file" /><br />
							<input type="submit" name="action" value="Upload Image" /><br /><br>
							<iframe id="upload_target" name="upload_target" src="" style="width:100px;height:100px;border:1px solid #ccc;"></iframe>
						</form>
						<div id="image_details"></div>
				 </div></li>				
			</ul>				
	</div>
	<script type="text/javascript">
	/*function init() {
		document.getElementById("uploadimage").onsubmit=function() {
			document.getElementById("uploadimage").target = "upload_target";
		}
	}
	function init() {
		document.getElementById("uploadimage").onsubmit=function() {
			document.getElementById("uploadimage").target = "upload_target";
			document.getElementById("upload_target").onload = uploadDone; //This function should be called when the iframe has compleated loading
				// That will happen when the file is completely uploaded and the server has returned the data we need.
		}
	}

	function uploadDone() { //Function will be called when iframe is loaded
		var ret = frames['upload_target'].document.getElementsByTagName("body")[0].innerHTML;
		var data = eval("("+ret+")"); //Parse JSON // Read the below explanations before passing judgment on me
		
		if(data.success) { //This part happens when the image gets uploaded.
			document.getElementById("image_details").innerHTML = "<img src='image_uploads/" + data.file_name + "' /><br />Size: " + data.size + " KB";
		}
		else if(data.failure) { //Upload failed - show user the reason.
			alert("Upload Failed: " + data.failure);
		}	
	}*/
	$(document).ready(function (e) {
	$("#uploadimage").on('submit',(function(e) {
	e.preventDefault();
	$("#message").empty();
	$('#loading').show();
	$.ajax({
	//url: "http://192.168.1.3:8080/hyi_2015_online/php/new_upload.php", // Url to which the request is send
	url: "http://192.168.1.4:8080/hyi_2015_online/php/upload_work_correct.php", // Url to which the request is send
	type: "POST",             // Type of request to be send, called as method
	data: new FormData(this), // Data sent to server, a set of key/value pairs (i.e. form fields and values)
	contentType: false,       // The content type used when sending data to the server.
	cache: false,             // To unable request pages to be cached
	processData:false,        // To send DOMDocument or non processed data file it is set to false
	success: function(jsonStr)   // A function to be called if request succeeds
	{
		if(jsonStr==1){
			alert("Upload success");
		}else{
			alert(jsonStr);
		}
	}
		/*dataType: "JSON",
		success: function (jsonStr) {
			if(jsonStr.success == '1'){
				alert("Upload Success");
			}else{
				alert("Upload Failed");
			}
		 }*/
	});
	}));
	});
</script>
	</script>   
    </body>
</html>
